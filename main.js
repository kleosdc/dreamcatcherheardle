// Example list of strings
/*VIDEO_ID: ["Album", "Song", "Date"] 65 in KV*/
playlist = {
  "iLXyoC2HRgY": ["Love Shake", "Love Shake", "September 22, 2014"],
  "XwCDkRiJucw": ["Love Shake", "Shut Up", "September 22, 2014"],
  "zihoyz0u_cs": ["Nightmare", "Chase Me", "January 13, 2017"],
  "5ST_EJBhwO4": ["Nightmare", "Emotion", "January 13, 2017"],
  "Lxfl8LRab_I": ["Fall asleep in the mirror", "GOOD NIGHT", "April 5, 2017"],
  "rSq1URfEEC8": ["Fall asleep in the mirror", "Lullaby", "April 5, 2017"],
  "39yeTdIuKJU": ["Prequel", "Fly High", "July 27, 2017"],
  "vuYQhvoYXIQ": ["Prequel", "Wake Up", "July 27, 2017"],
  "41lCjS3Ymx8": ["Prequel", "Sleep walking", "July 27, 2017"],
  "Ecc0N9VBXqM": ["Full Moon", "Full Moon", "January 12, 2018"],
  "I5_BQAtwHws": ["Escape the ERA", "YOU AND I", "May 10, 2018"],
  "3iqEB5LlO2k": ["Escape the ERA", "Mayday", "May 10, 2018"],
  "EhwX3y9Ty20": ["Escape the ERA", "Which a star", "May 10, 2018"],
  "jmYCH6p7HPg": ["Escape the ERA", "Scar", "May 10, 2018"],
  "pN0dkjp1deQ": ["Alone In The City", "What", "September 20, 2018"],
  "iITO8xBvcHI": ["Alone In The City", "Wonderland", "September 20, 2018"],
  "eoqwlzfyRSY": ["Alone In The City", "Trap", "September 20, 2018"],
  "BO6rEpssQDY": ["Alone In The City", "July 7th", "September 20, 2018"],
  "3F2nRTyVPGo": ["Over the Sky", "Over the Sky", "January 16, 2019"],
  "Pq_mbTSR-a0": ["The End of Nightmare", "PIRI", "Febuary 13, 2019"],
  "54j-ePPQStU": ["The End of Nightmare", "Diamond", "Febuary 13, 2019"],
  "xjKn61YOHIk": ["The End of Nightmare", "And there was no one left", "Febuary 13, 2019"],
  "X1Mte4dHW1s": ["The End of Nightmare", "Daydream", "Febuary 13, 2019"],
  "W761DtH1oRg": ["Raid of Dream", "Deja Vu", "September 18, 2019"],
  "5ycjCmDYD2I": ["Raid of Dream", "The curse of the Spider", "September 18, 2019"],
  "ovw4Cy-zMiI": ["Raid of Dream", "Silent Night", "September 18, 2019"],
  "jG5CwtPDGB8": ["Raid of Dream", "Polaris", "September 18, 2019"],
  "FKlGHHhTOsQ": ["Dystopia: The Tree of Language", "Scream", "February 18, 2020"],
  "-6_LfeObHPU": ["Dystopia: The Tree of Language", "Tension", "February 18, 2020"],
  "RKBJVdjOHUY": ["Dystopia: The Tree of Language", "Red Sun", "February 18, 2020"],
  "t3ptx0spMtQ": ["Dystopia: The Tree of Language", "Black Or White", "February 18, 2020"],
  "Fo64mNT5GOA": ["Dystopia: The Tree of Language", "Jazz Bar", "February 18, 2020"],
  "BgLhbkKu1s4": ["Dystopia: The Tree of Language", "SAHARA", "February 18, 2020"],
  "okGlx-t9hXA": ["Dystopia: The Tree of Language", "In The Frozen", "February 18, 2020"],
  "Um2tn8zM8bM": ["Dystopia: The Tree of Language", "Daybreak", "February 18, 2020"],
  "MZ4JGye4dQU": ["Dystopia : Lose Myself", "BOCA", "August 17, 2020"],
  "TqcPjwKU_zc": ["Dystopia : Lose Myself", "Break The Wall", "August 17, 2020"],
  "F_2W8SW8iXA": ["Dystopia : Lose Myself", "Canâ€™t get you out of my mind", "August 17, 2020"],
  "nqrHHZjc_Rs": ["Dystopia : Lose Myself", "Dear", "August 17, 2020"],
  "1QD0FeZyDtQ": ["Dystopia : Road to Utopia", "Odd Eye", "January 26, 2021"],
  "CF0b5MDBJu0": ["Dystopia : Road to Utopia", "Wind Blows", "January 26, 2021"],
  "wKXjvh-wYKY": ["Dystopia : Road to Utopia", "Poison Love", "January 26, 2021"],
  "SGemMpImsXg": ["Dystopia : Road to Utopia", "4 Memory", "January 26, 2021"],
  "Ag2AWsFY5Ns": ["Dystopia : Road to Utopia", "New Days", "January 26, 2021"],
  "PEKkdIT8JPM": ["Summer Holiday", "BEcause", "July 30, 2021"],
  "sNgM3uBLkEU": ["Summer Holiday", "Airplane", "July 30, 2021"],
  "cTrWrRmHICw": ["Summer Holiday", "Whistle", "July 30, 2021"],
  "AWemTDbxs14": ["Summer Holiday", "Alldaylong", "July 30, 2021"],
  "5gvfp-haKXc": ["Summer Holiday", "A Heart of Sunflower", "July 30, 2021"],
  "jZgfRnnKhlA": ["Apocalypse : Save Us", "Locked Inside A Door", "April 12, 2022"],
  "z4t9LLq1Nk0": ["Apocalypse : Save Us", "Maison", "April 12, 2022"],
  "chYPWJk6s6E": ["Apocalypse : Save Us", "Starlight", "April 12, 2022"],
  "FFXtTiikOic": ["Apocalypse : Save Us", "Together", "April 12, 2022"],
  "2L0q-nWS1xA": ["Apocalypse : Save Us", "Cherry", "April 12, 2022"],
  "oxPyRRKEtHI": ["Apocalypse : Save Us", "No Dot", "April 12, 2022"],
  "CowRTDlxbWg": ["Apocalypse : Save Us", "Entrancing", "April 12, 2022"],
  "jQ_ogJWssXU": ["Apocalypse : Save Us", "Winter", "April 12, 2022"],
  "1HwjxbE7_Qw": ["Apocalypse : Save Us", "For", "April 12, 2022"],
  "nivI7w9HagI": ["Apocalypse : Save Us", "Beauty Full", "April 12, 2022"],
  "iYvErpLnQ-8": ["Apocalypse : Save Us", "Playground", "April 12, 2022"],
  "jKrJBVLnRiM": ["Apocalypse : Follow  Us", "Vision", "October 11, 2022"],
  "bOLq9w-JSF0": ["Apocalypse : Follow  Us", "Fairytale", "October 11, 2022"],
  "022GXgNuoc8": ["Apocalypse : Follow  Us", "Some Love", "October 11, 2022"],
  "hdt-SIpJqFE": ["Apocalypse : Follow  Us", "Rainy Day", "October 11, 2022"],
  "G3fUZUh1LBs": ["Reason", "Reason", "January 13, 2023"],
}

// Create an empty list for completed strings
let completedList = {};

let STARTED = false;
let HALTSTATE = false;
let songHALT = false;
let albumHALT = false;
let releaseHALT = false;

let VIDEO_ID = '';
let START_TIME = 0;
let START_TIME_SECONDS = 0;
let END_TIME = 0;

let CURRENT_SONG = '';
let CURRENT_ALBUM = '';
let CURRENT_RELEASE = '';

let SCORE = 0;
let giveScore = 1;
let skipped = 0;
let timed = 0;
let moretime = 0;
let MAX_TRIES = 10;
let SONGSCORRECT = 0;
let songClicks = 0;
let ALBUMCORRECT = 0;
let albumClicks = 0;
let RELEASECORRECT = 0;
let releaseClicks = 0;


var player;

let nextButton = document.getElementById("nextButton");
let timeButton = document.getElementById("timeButton");
let resetButton = document.getElementById("resetButton");
let skipButton = document.getElementById("skipButton");
let alertCloseButton = document.getElementById("alertCloseButton");
let modalButton = document.getElementById("modalButton");
let playBtn = document.getElementById("playBtn");

let choiceSection = document.getElementById("choiceSection");
let songColumn = document.getElementById("songColumn");
let albumColumn = document.getElementById("albumColumn");
let releaseColumn = document.getElementById("releaseColumn");

let imageHolder = document.getElementById("imageHolder");
let playerHolder = document.getElementById("player-container");
let scoreCard = document.getElementById("scoreCard");
let messageText = document.getElementById("messageText");
let modalPopup = document.getElementById("gamealert");
let modalHeader = document.getElementById("modalHeader");
let modalText = document.getElementById("modalText");
let headTitle = document.getElementById("headerTitle");

let input = document.getElementById("myInput");

// CALLER
starterPack();


// Checks if there are songs listed in playlist - CHECKED
function availableSongs() {
  if (Object.keys(playlist).length <= 0) {
    modalPopup.style.display = 'block';
    modalGameAlert("You finished!", "Here are your results.", "Play again!");
    return false
  }
  return true
}

// Randomly select a song from playlist - CHECKED
function getSong() {
  if (availableSongs()) {
    let keys = Object.keys(playlist);
    // Generate a random index within the range of the original list
    let randomIndex = Math.floor(Math.random() * keys.length);
    let randomKey = keys[randomIndex];

    CURRENT_SONG = playlist[randomKey][1];
    CURRENT_ALBUM = playlist[randomKey][0];
    CURRENT_RELEASE = playlist[randomKey][2];
    //console.log(`Song: ${CURRENT_SONG} - Album: ${CURRENT_ALBUM} - Release: ${CURRENT_RELEASE}`);

    completedList[randomKey] = playlist[randomKey];

    // Get the randomly selected string from the original list
    VIDEO_ID = keys[randomIndex];

    delete playlist[randomKey];

    // Print the updated lists
    //console.log("Original List:", playlist);
    //console.log("Completed List:", completedList);
    getTimeframe();
  }
}

// Format our timeframe in minutes:seconds - CHECKED
function getTimeframe() {
  // Get a random number of seconds between 25 and 150 (2 minutes and 30 seconds)
  let rads1 = Math.floor(Math.random() * (150 - 25 + 1) + 25);
  let rads2 = rads1 + 1;

  // Convert the random number of seconds to Date objects
  let startTimeConverter = new Date(rads1 * 1000);
  let endTimeConverter = new Date(rads2 * 1000);

  // Format the times as x:xx
  START_TIME = startTimeConverter.toISOString().substr(14, 5);
  START_TIME_SECONDS = START_TIME.split(':').reduce((acc, val) => acc * 60 + parseInt(val, 10), 0);
  END_TIME = endTimeConverter.toISOString().substr(14, 5);

  // Print the formatted times
  //console.log(START_TIME, END_TIME, START_TIME_SECONDS);
}


// Resets playlist to default
function resetGame() {
  if (STARTED) {
    Object.assign(playlist, completedList);

    for (const key in completedList) {
      if (completedList.hasOwnProperty(key)) {
        delete completedList[key];
      }
    }
    moretime = 0;
    MAX_TRIES = 10;
    SCORE = 0;
    skipped = 0;
    timed = 0;
    SONGSCORRECT = 0;
    songClicks = 0;
    ALBUMCORRECT = 0;
    albumClicks = 0;
    RELEASECORRECT = 0;
    releaseClicks = 0;
    headTitle.textContent = `${65-Object.keys(playlist).length}/${Object.keys(playlist).length}`;
    scoreCard.textContent = SCORE
    pkboo([[nextButton,"visibility","visible"]]);
    nextButton.click();
  } 
}

function gameStart() {
  STARTED = true;
}

function gameStop() {
  STARTED = false;
}

function starterPack() {
  loadData(songColumn, 1);    // 65
  loadData(albumColumn, 0);   // 17
  loadData(releaseColumn, 2); // 17

  headTitle.textContent = "Dreamcatcher Heardle";
  //messageText.style.visibility = 'hidden';
  pkboo([[messageText,"visibility","hidden"]]);
}

function modalGameAlert(_title, _text, _buttonText) {
  HALTSTATE = true;
  modalHeader.textContent = _title;
  modalText.textContent = `${_text}.\nYou got ${SONGSCORRECT} song/s correct (${songClicks} click/s).\nYou got ${ALBUMCORRECT} album/s correct (${albumClicks} click/s).\nYou got ${RELEASECORRECT} release/s correct (${releaseClicks} click/s).\nYou added time ${timed} time/s.\nYou skipped ${skipped} song/s.\nFinal score: ${SCORE}`;
  modalButton.textContent = _buttonText;
}

function modalReset() {
  pkboo([[modalPopup,"display","none"]]);
  modalHeader.textContent = "";
  modalText.textContent = "";
  modalButton.textContent = "";
}

function liElementsReset(ulElem) {
  // Get all of the li elements inside the ul element
  const liElements = ulElem.getElementsByTagName("li");

  // Loop through all of the li elements and set their display property to "list-item"
  for (let i = 0; i < liElements.length; i++) {
    if (liElements[i].style.display === "none") {
      liElements[i].style.display = "list-item";
    }
  }
}

// Update video on screen with new ID, Start time, and End time
function updatePlayer() {
  gameStart();
  youTubePlayerChangeVideoId(videoId, minutesToSeconds(START_TIME), minutesToSeconds(END_TIME));
  displayStats();
}

// Checks if game has started or not.
function gameStatus() {
  if (Object.keys(completedList).length == 0 && !(STARTED)) {
    alert('Game has not started, press "Start" then "Play"');
    return false
  }
  return true
}

// Debugger
function displayStats() {
  //console.log(`Songs remaining: ${Object.keys(playlist).length} : Complete: ${Object.keys(completedList).length} : Timeframe: ${START_TIME}-${END_TIME}`);
}

function alertMessage() {

}

// Load data from playlist to be visualized
function loadData(_elem, _indx) {
  // Create an empty array to hold the <li> elements
  let liArr = [];
  // Create an empty object to track the values already added
  let addedValues = {};
  // Loop through each key in the object
  for (let key in playlist) {
    // Concatenate the two values using the array syntax
    let value = playlist[key][_indx];
    // Check if the value has already been added
    if (!addedValues[value]) {
      // If the value hasn't been added, create a new <li> element
      const li = document.createElement("li");
      // Set the innerHTML of the <li> element to the concatenated values
      li.innerHTML = value;
      // Add the <li> element to the array
      liArr.push(li);
      // Set the value as added in the addedValues object
      addedValues[value] = true;
    }
  }
  if (_elem.id != "releaseColumn") {
    // Shuffle the array using Array.sort() and Math.random()
    liArr.sort(() => Math.random() - 0.5);
  }
  // Add the shuffled <li> elements to the <ul> element
  liArr.forEach(li => _elem.appendChild(li));
}


choiceSection.addEventListener("click", (e) => {
  if (!(HALTSTATE) || (!(songHALT) || !(albumHALT) || !(releaseHALT))) {
    //console.log(e.target.parentElement.id);
    if (e.target.tagName == "LI" && gameStatus()) {
      if (e.target.parentElement.id == "songColumn" && !(songHALT)) {
        (messageText.style.visibility = "visible", clearTimeout(window.timeoutId), window.timeoutId = setTimeout(() => messageText.style.visibility = "hidden", 3000))
        songClicks += 1;
        //console.log(e.target.textContent, CURRENT_SONG);
        if (MAX_TRIES >= 0) {
          if (e.target.textContent == CURRENT_SONG) {
            youTubePlayerChangeVideoId(videoId, START_TIME_SECONDS, (START_TIME_SECONDS+30));
            liElementsReset(songColumn);
            input.value = "";
            HALTSTATE = true;
            songHALT = true;

            setTimeout(() => { playVideo(); }, 1000);
            imageHolder.style.display = "none";
            playerHolder.style.display = "block";
            SCORE += parseFloat(giveScore.toFixed(2));
            nextButton.style.visibility = "visible";
            messageText.textContent = "Correct!";
            //console.log('Correct song.', SCORE, giveScore);
            SONGSCORRECT += 1;
            giveScore = 1;
            moretime = 0;
          } else {
            giveScore = parseFloat((giveScore-0.1).toFixed(2));
            MAX_TRIES -= 1;
            messageText.textContent = `Incorrect! Tries remaining: ${MAX_TRIES}`;
            //console.log('Wrong song selected.', SCORE, giveScore);
          }
        }
        if (MAX_TRIES < 0) {
          modalPopup.style.display = 'block';
          modalGameAlert("Game Over!", "You did not win, try again", "Try Again!");
        }
      }

      if (e.target.parentElement.id == "albumColumn" && !(albumHALT)) {
        (messageText.style.visibility = "visible", clearTimeout(window.timeoutId), window.timeoutId = setTimeout(() => messageText.style.visibility = "hidden", 3000))
        albumClicks += 1;
        if (e.target.textContent == CURRENT_ALBUM) {
          ALBUMCORRECT += 1;
          albumHALT = true;
          messageText.textContent = "Correct album!";
          //console.log(e.target.textContent, CURRENT_ALBUM, "correct!");
          SCORE += Number((1).toFixed(2));
        } else {
          messageText.textContent = "Incorrect!";
          //console.log(e.target.textContent, CURRENT_ALBUM, "wrong!")
        }
      }

      if (e.target.parentElement.id == "releaseColumn" && !(releaseHALT)) {
        (messageText.style.visibility = "visible", clearTimeout(window.timeoutId), window.timeoutId = setTimeout(() => messageText.style.visibility = "hidden", 3000))
        releaseClicks += 1;
        if (e.target.textContent == CURRENT_RELEASE) {
          RELEASECORRECT += 1;
          releaseHALT = true;
          //console.log(e.target.textContent, CURRENT_RELEASE, "correct!");
          messageText.textContent = "Correct release!";
          SCORE += Number((1).toFixed(2));
        } else {
          messageText.textContent = "Incorrect!";
          //console.log(e.target.textContent, CURRENT_RELEASE, "wrong!");
        }
      }
      
    }
    scoreCard.textContent = SCORE;
  }
});

playBtn.addEventListener("click", (e) => {
  gameStart();
});

function addSkip() {
  skipped += 1;
}

function addTime() {
  timed += 1;
}


function showIMG() {
  //imageHolder.style.display = "block";
  //playerHolder.style.display = "none";
  pkboo([[imageHolder,"display","block"],[playerHolder,"display","none"]]);
}

function showPLAYER() {
  //imageHolder.style.display = "none";
  //playerHolder.style.display = "block";
  pkboo([[imageHolder,"display","none"],[playerHolder,"display","block"]]);
}


function pkboo(_listElem) {
  // Loop through the list
  for (let i = 0; i < _listElem.length; i++) {
    // Check if the current item is a nested list
    if (Array.isArray(_listElem[i])) {
      // Check if the element is a valid HTML element
      let element = _listElem[i][0];
      let property = _listElem[i][1];
      let value = _listElem[i][2];
      //console.log(`${element} - ${property} - ${value}`);
      if (!(element instanceof HTMLElement)) {
        console.error("Error: First parameter must be a valid HTML element");
        return;
      }

      // Check if the second parameter is a valid style property
      if (property !== "visibility" && property !== "display") {
        console.error("Error: Second parameter must be 'visibility' or 'display'");
        return;
      }

      // Check if the third parameter is a valid value
      if (value !== "visible" && value !== "hidden" && value !== "none" && value !== "block") {
        console.error("Error: Third parameter must be 'visible', 'hidden', 'none', or 'block'");
        return;
      }

      // Set the style property of the element to the specified value
      element.style[property] = value;
    }
  }
}

function posNumbers(_oNum, _decBy) {
  if ((_oNum - _decBy) < 0) {
    return 0;
  }
  return (_oNum - _decBy);
}

nextButton.addEventListener("click", (e) => {
  HALTSTATE = false;
  songHALT = false;
  albumHALT = false;
  releaseHALT = false;
  headTitle.textContent = `${65-Object.keys(playlist).length}/${Object.keys(playlist).length}`;
  if (availableSongs()) {
    // Check if game has started
    if (!(gameStatus())) {
      return
    }
    if (document.getElementsByClassName('playButton')[0].textContent != "Start") {
      giveScore = 1;
      showIMG();
      pkboo([[nextButton, "visibility", "hidden"]]);
      e.preventDefault();
      getSong();
      videoId = YouTubeGetID("https://www.youtube.com/watch?v="+VIDEO_ID);
      updatePlayer();
      setTimeout(() => { playVideo(); }, 1000);
    }
  }
});

timeButton.addEventListener("click", (e) => {
  if (!(HALTSTATE) && STARTED) {


    if (moretime == 6) {
      (messageText.style.visibility = "visible", clearTimeout(window.timeoutId), window.timeoutId = setTimeout(() => messageText.style.visibility = "hidden", 3000))
      messageText.textContent = `You can't add more time.`;
      return
    }
    
    moretime +=1;
    addTime();
    (messageText.style.visibility = "visible", clearTimeout(window.timeoutId), window.timeoutId = setTimeout(() => messageText.style.visibility = "hidden", 3000))
    messageText.textContent = `Time added, remaining: ${6-moretime}`;
    
    //console.log(END_TIME);
    e.preventDefault();
    let timeStr = `${Math.floor(((START_TIME_SECONDS+moretime)+((moretime+1))) / 60).toString().padStart(2, "0")}:${(((START_TIME_SECONDS+moretime)+((moretime+1))) % 60).toString().padStart(2, "0")}`;
    END_TIME = timeStr;
    //console.log(END_TIME, moretime, ((START_TIME_SECONDS+1)+((moretime+1))));
    updatePlayer();
  } else {
    // Check if game has started
    if (!(gameStatus())) {
      return
    }
  }
});

resetButton.addEventListener("click", (e) => {
  resetGame();
});

skipButton.addEventListener("click", (e) => {
  if (!(HALTSTATE) && STARTED) {
    if (nextButton.style.visibility != "visible") {
      giveScore = 1;
      moretime = 0;
      addSkip();
      nextButton.click();
    }
  }
});

alertCloseButton.addEventListener("click", (e) => {
  pkboo([[modalPopup,"display","none"]]);
});

modalButton.addEventListener("click", (e) => {
  modalReset();
  giveScore = 1;
  resetButton.click();
});


function youTubePlayerCurrentTimeChange(currentTime) {

    player.currentTimeSliding = false;
        player.seekTo(currentTime*player.getDuration()/100, true);
    
}

function youTubePlayerVolumeChange(volume) {
        player.setVolume(volume);
}

function youTubePlayerCurrentTimeSlide() {

    player.currentTimeSliding = true;
}

function pauseVideo() {
  player.pauseVideo();
}
function playVideo() {
  if (document.getElementsByClassName('playButton')[0].textContent == "Start") {
    getSong();
    videoId = YouTubeGetID("https://www.youtube.com/watch?v="+VIDEO_ID);
    youTubePlayerChangeVideoId(videoId, minutesToSeconds(START_TIME), minutesToSeconds(END_TIME));

    document.getElementsByClassName('playButton')[0].textContent = "Play";
  }
  player.playVideo();
  player.seekTo(START_TIME_SECONDS);
}

function YouTubeGetID(url) {
  let ID = "";
  url = url
    .replace(/(>|<)/gi, "")
    .split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/);
  if (url[2] !== undefined) {
    ID = url[2].split(/[^0-9a-z_\-]/i);
    ID = ID[0];
  } else {
    ID = url;
  }
  return ID;
}

function youTubePlayerChangeVideoId(videoId, starttime, endtime) {
  player.cueVideoById({ suggestedQuality: "small", videoId: videoId, startSeconds: starttime, endSeconds: endtime });
  pauseVideo();
}

function onYouTubeIframeAPIReady() {
  player = new YT.Player("player", {
    height: 270,
    width: 480,
    videoId: "",
    playerVars: {
      playsinline: 1,
      autoplay: 1,
      controls: 1,
    },
    events: {
      'onReady': function (event) {
        event.target.setVolume(40);
        onPlayerReady;
      },
      onStateChange: onPlayerStateChange,
    },
  });
}


function onPlayerReady() {
  console.log(true);
}

let done = false;
function onPlayerStateChange(event) {
  if (event.data == YT.PlayerState.PLAYING && !done) {
    done = true;
  }
}

function minutesToSeconds(mins) {
      /**
       * ~~ mins param must be a str in "1:00" format ~~
       * Converts time in xx:xx format to seconds
       */

      let p = mins.split(":");
      return Number((Number(p[0]) * 60 + Number(p[1])).toFixed(3));
}

function filterList() {
  let filter = input.value.toLowerCase();
  
  // Get the list and all list items
  let items = songColumn.getElementsByTagName("li");
  
  // Loop through all list items, and hide those that don't match the search query
  for (let i = 0; i < items.length; i++) {
    let item = items[i];
    if (item.innerHTML.toLowerCase().indexOf(filter) > -1) {
      item.style.display = "";
    } else {
      item.style.display = "none";
    }
  }
}